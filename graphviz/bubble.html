<!DOCTYPE html>

<div id="chart"></div>
<meta charset="utf-8">
<style>

text {
  font: 10px sans-serif;
}

</style>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script>

var json = {"name":"anvisha", "children":[{"name":"cgitop", "children":[{"name": "cgi", "size":7}]},{"name":"inspecttop", "children":[{"name": "inspect", "size":1}]},{"name":"stringtop", "children":[{"name": "string", "size":10}]},{"name":"simplejsontop", "children":[{"name": "simplejson", "size":32}]},{"name":"unittesttop", "children":[{"name": "unittest", "size":2}]},{"name":"randomtop", "children":[{"name": "random", "size":14}]},{"name":"ostop", "children":[{"name": "os", "size":47}]},{"name":"utiltop", "children":[{"name": "util", "size":48}]},{"name":"gziptop", "children":[{"name": "gzip", "size":2}]},{"name":"contextlibtop", "children":[{"name": "contextlib", "size":1}]},{"name":"httplib2top", "children":[{"name": "httplib2", "size":71}]},{"name":"loggingtop", "children":[{"name": "logging", "size":22}]},{"name":"copytop", "children":[{"name": "copy", "size":8}]},{"name":"oauth2clienttop", "children":[{"name": "oauth2client", "size":33}]},{"name":"typestop", "children":[{"name": "types", "size":1}]},{"name":"utctop", "children":[{"name": "utc", "size":6}]},{"name":"hashlibtop", "children":[{"name": "hashlib", "size":2}]},{"name":"PILtop", "children":[{"name": "PIL", "size":1}]},{"name":"sockettop", "children":[{"name": "socket", "size":62}]},{"name":"StringIOtop", "children":[{"name": "StringIO", "size":2}]},{"name":"webbrowsertop", "children":[{"name": "webbrowser", "size":1}]},{"name":"pickletop", "children":[{"name": "pickle", "size":4}]},{"name":"tracebacktop", "children":[{"name": "traceback", "size":1}]},{"name":"keyringtop", "children":[{"name": "keyring", "size":3}]},{"name":"urllibtop", "children":[{"name": "urllib", "size":35}]},{"name":"djangotop", "children":[{"name": "django", "size":400}]},{"name":"urlparsetop", "children":[{"name": "urlparse", "size":9}]},{"name":"retop", "children":[{"name": "re", "size":27}]},{"name":"jsontop", "children":[{"name": "json", "size":2}]},{"name":"foursquaretop", "children":[{"name": "foursquare", "size":6}]},{"name":"collectionstop", "children":[{"name": "collections", "size":3}]},{"name":"sqlite3top", "children":[{"name": "sqlite3", "size":1}]},{"name":"getopttop", "children":[{"name": "getopt", "size":7}]},{"name":"requeststop", "children":[{"name": "requests", "size":7}]},{"name":"translatetop", "children":[{"name": "translate", "size":5}]},{"name":"numpytop", "children":[{"name": "numpy", "size":32}]},{"name":"emailtop", "children":[{"name": "email", "size":11}]},{"name":"tweepytop", "children":[{"name": "tweepy", "size":16}]},]}

// var json = {"name":"anant", "children":[{"name":"teleporttop", "children":[{"name": "teleport", "size":16}]},{"name":"psycopg2top", "children":[{"name": "psycopg2", "size":3}]},{"name":"BeautifulSouptop", "children":[{"name": "BeautifulSoup", "size":2}]},{"name":"retop", "children":[{"name": "re", "size":2}]},{"name":"jsontop", "children":[{"name": "json", "size":9}]},{"name":"collectionstop", "children":[{"name": "collections", "size":4}]},{"name":"configtop", "children":[{"name": "config", "size":15}]},{"name":"relaytop", "children":[{"name": "relay", "size":20}]},{"name":"optparsetop", "children":[{"name": "optparse", "size":1}]},{"name":"stemtop", "children":[{"name": "stem", "size":1}]},{"name":"utiltop", "children":[{"name": "util", "size":2}]},{"name":"scipytop", "children":[{"name": "scipy", "size":3}]},{"name":"datahubtop", "children":[{"name": "datahub", "size":4}]},{"name":"constantstop", "children":[{"name": "constants", "size":2}]},{"name":"thrifttop", "children":[{"name": "thrift", "size":1}]},{"name":"utctop", "children":[{"name": "utc", "size":1}]},{"name":"hashlibtop", "children":[{"name": "hashlib", "size":1}]},{"name":"tasktop", "children":[{"name": "task", "size":1}]},{"name":"loggingtop", "children":[{"name": "logging", "size":3}]},{"name":"djangotop", "children":[{"name": "django", "size":100}]},{"name":"lamsontop", "children":[{"name": "lamson", "size":1}]},{"name":"ostop", "children":[{"name": "os", "size":16}]},{"name":"multiprocessingtop", "children":[{"name": "multiprocessing", "size":2}]},]}

// var json = {"name":"danielle", "children":[{"name":"tracebacktop", "children":[{"name": "traceback", "size":1}]},{"name":"stringtop", "children":[{"name": "string", "size":7}]},{"name":"UserDicttop", "children":[{"name": "UserDict", "size":8}]},{"name":"unittesttop", "children":[{"name": "unittest", "size":6}]},{"name":"randomtop", "children":[{"name": "random", "size":19}]},{"name":"matplotlibtop", "children":[{"name": "matplotlib", "size":4}]},{"name":"clustertop", "children":[{"name": "cluster", "size":4}]},{"name":"StringIOtop", "children":[{"name": "StringIO", "size":1}]},{"name":"pprinttop", "children":[{"name": "pprint", "size":1}]},{"name":"chardettop", "children":[{"name": "chardet", "size":3}]},{"name":"gziptop", "children":[{"name": "gzip", "size":1}]},{"name":"numpytop", "children":[{"name": "numpy", "size":7}]},]};

// var json = {"name":"philip", "children":[{"name":"randomtop", "children":[{"name": "random", "size":3}]},{"name":"iotop", "children":[{"name": "io", "size":0}]},{"name":"PILtop", "children":[{"name": "PIL", "size":1}]},{"name":"pprinttop", "children":[{"name": "pprint", "size":2}]},{"name":"urllibtop", "children":[{"name": "urllib", "size":1}]},{"name":"retop", "children":[{"name": "re", "size":10}]},{"name":"jsontop", "children":[{"name": "json", "size":13}]},{"name":"GChartWrappertop", "children":[{"name": "GChartWrapper", "size":3}]},{"name":"collectionstop", "children":[{"name": "collections", "size":3}]},{"name":"sqlite3top", "children":[{"name": "sqlite3", "size":1}]},{"name":"newtop", "children":[{"name": "new", "size":0}]},{"name":"cgitop", "children":[{"name": "cgi", "size":4}]},{"name":"optparsetop", "children":[{"name": "optparse", "size":2}]},{"name":"inspecttop", "children":[{"name": "inspect", "size":1}]},{"name":"webbrowsertop", "children":[{"name": "webbrowser", "size":1}]},{"name":"copytop", "children":[{"name": "copy", "size":1}]},{"name":"typestop", "children":[{"name": "types", "size":7}]},{"name":"hashlibtop", "children":[{"name": "hashlib", "size":1}]},{"name":"loggingtop", "children":[{"name": "logging", "size":1}]},{"name":"StringIOtop", "children":[{"name": "StringIO", "size":1}]},{"name":"tracebacktop", "children":[{"name": "traceback", "size":2}]},{"name":"djangotop", "children":[{"name": "django", "size":7}]},{"name":"ostop", "children":[{"name": "os", "size":20}]},]};

function filling(packageName){
  var colors = ["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5","#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6","#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];

  var packages = ['unittest', 'random', 'cluster', 'contextlib', 'io', 'config', 'oauth2client', 'teleport', 'PIL', 'relay', 'psycopg2', 'pprint', 'BeautifulSoup', 'urllib', 're', 'json', 'foursquare', 'collections', 'constants', 'sqlite3', 'getopt', 'translate', 'numpy', 'email', 'tweepy', 'cgi', 'string', 'simplejson', 'optparse', 'UserDict', 'inspect', 'matplotlib', 'stem', 'util', 'GChartWrapper', 'scipy', 'webbrowser', 'httplib2', 'new', 'datahub', 'copy', 'lamson', 'types', 'thrift', 'utc', 'hashlib', 'task', 'logging', 'socket', 'StringIO', 'os', 'traceback', 'keyring', 'django', 'urlparse', 'chardet', 'gzip', 'requests', 'pickle', 'multiprocessing']

  var stripped = packageName.slice(0, packageName.length-3);
  window.console.log(stripped);
  var index = packages.indexOf(stripped);
  window.console.log(colors[index]);
  return colors[index];
}

function textSize(value) {
  if(value < 7){
    return "10px";
  }
  else{
    return "15px";
  }
}

var r = 960,
    format = d3.format(",d"),
    fill = d3.scale.category20c();
    window.console.log(fill);

var bubble = d3.layout.pack()
    .sort(null)
    .size([r, r])
    .padding(1.5);

var vis = d3.select("#chart").append("svg")
    .attr("width", r)
    .attr("height", r)
    .attr("class", "bubble");


  var node = vis.selectAll("g.node")
      .data(bubble.nodes(classes(json))
      .filter(function(d) { return !d.children; }))
    .enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });

  node.append("title")
      .text(function(d) { return d.className + ": " + format(d.value); });

  node.append("circle")
      .attr("r", function(d) { return d.r; })
      .style("fill", function(d) { return filling(d.packageName); });

  node.append("text")
      .attr("text-anchor", "middle")
      .style("font-size", function(d) {return textSize(d.value); }) 
      .attr("dy", ".3em")
      .text(function(d) { return d.className.substring(0, d.r / 3); });

// Returns a flattened hierarchy containing all leaf nodes under the root.
function classes(root) {
  var classes = [];

  function recurse(name, node) {
    if (node.children) node.children.forEach(function(child) { recurse(node.name, child); });
    else classes.push({packageName: name, className: node.name, value: node.size});
    window.console.log(node.size);
  }

  recurse(null, root);
  return {children: classes};
}

</script>